<span class="foreground-8">  1 </span><span class="foreground-3">integer</span><span class="foreground-15"> :: my_seed                                             </span>                <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8">  2 </span><span class="foreground-15">        becomes                                                </span>                <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8">  3 </span><span class="foreground-15">  </span><span class="foreground-3">integer</span><span class="foreground-15">, </span><span class="foreground-3">optional</span><span class="foreground-15"> :: my_seed                                    </span>             <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8">  4 </span><span class="foreground-14">module</span><span class="foreground-15"> ran_mod                                                                 <span class="background-0"> 
</span></span><span class="foreground-8">  5 </span><span class="foreground-7">! ran1 returns a uniform random number between 0-1 </span><span class="foreground-15">                            <span class="background-0"> 
</span></span><span class="foreground-8">  6 </span><span class="foreground-7">! the seed is optional and used to reset the generator </span><span class="foreground-15">                        <span class="background-0"> 
</span></span><span class="foreground-8">  7 </span><span class="foreground-14">contains</span><span class="foreground-15">       </span>                <span class="foreground-15">                    </span>                            <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8">  8 </span><span class="foreground-15">   </span><span class="foreground-14">function</span><span class="foreground-15"> ran1(my_seed)                                                      <span class="background-0"> 
</span></span><span class="foreground-8">  9 </span><span class="foreground-15">      </span><span class="foreground-14">use</span><span class="foreground-15"> numz    </span>             <span class="foreground-15">                       </span>                         <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 10 </span><span class="foreground-15">      </span><span class="foreground-3">implicit</span><span class="foreground-15"> </span><span class="foreground-3">none</span><span class="foreground-15">                                                </span>            <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 11 </span><span class="foreground-3">      real</span><span class="foreground-15">(b8) ran1,r </span>         <span class="foreground-15">                           </span>                     <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 12 </span><span class="foreground-15">      </span><span class="foreground-3">integer</span><span class="foreground-15">, </span><span class="foreground-3">optional</span><span class="foreground-15"> ,</span><span class="foreground-3">intent</span><span class="foreground-15">(</span><span class="foreground-3">in</span><span class="foreground-15">) :: my_seed  </span><span class="foreground-7">! optional argument not changed<span class="background-0"> </span>in the routine 
</span><span class="foreground-8"> 13 </span><span class="foreground-15">      </span><span class="foreground-3">integer</span><span class="foreground-15">,</span><span class="foreground-3">allocatable</span><span class="foreground-15"> :: seed(:)                               </span>            <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 14 </span><span class="foreground-15">      </span><span class="foreground-3">integer</span><span class="foreground-15"> the_size,j                                                </span>       <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 15 </span><span class="foreground-15">      </span><span class="foreground-12">if</span><span class="foreground-15">(</span><span class="foreground-11">present</span><span class="foreground-15">(my_seed))</span><span class="foreground-12">then</span><span class="foreground-15">            </span><span class="foreground-7">! use the seed if present </span>           <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 16 </span><span class="foreground-15">          </span><span class="foreground-11">call</span><span class="foreground-15"> </span><span class="foreground-11">random_seed</span><span class="foreground-15">(</span><span class="foreground-11">size</span><span class="foreground-14">=</span><span class="foreground-15">the_size) </span><span class="foreground-7">! how big is the intrisic seed? </span><span class="foreground-15">     <span class="background-0"> 
</span></span><span class="foreground-8"> 17 </span><span class="foreground-15">          </span><span class="foreground-12">allocate</span><span class="foreground-15">(seed(the_size))        </span><span class="foreground-7">! allocate space for seed </span>           <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 18 </span><span class="foreground-15">          </span><span class="foreground-12">do</span><span class="foreground-15"> j</span><span class="foreground-14">=</span><span class="foreground-9">1</span><span class="foreground-15">,the_size                 </span><span class="foreground-7">! create the seed </span><span class="foreground-15">                   <span class="background-0"> 
</span></span><span class="foreground-8"> 19 </span><span class="foreground-15">             seed(j)</span><span class="foreground-14">=</span><span class="foreground-11">abs</span><span class="foreground-15">(my_seed)</span><span class="foreground-14">+</span><span class="foreground-15">(j</span><span class="foreground-14">-</span><span class="foreground-9">1</span><span class="foreground-15">)   </span><span class="foreground-7">! abs is generic </span>                    <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 20 </span><span class="foreground-15">          </span><span class="foreground-12">enddo</span><span class="foreground-15">                                                                <span class="background-0"> 
</span></span><span class="foreground-8"> 21 </span><span class="foreground-15">          </span><span class="foreground-11">call</span><span class="foreground-15"> </span><span class="foreground-11">random_seed</span><span class="foreground-15">(put</span><span class="foreground-14">=</span><span class="foreground-15">seed)      </span><span class="foreground-7">! assign the seed </span><span class="foreground-15"> </span>                  <span class="background-0"><span class="foreground-15"> 
</span></span><span class="foreground-8"> 22 </span><span class="foreground-15">          </span><span class="foreground-12">deallocate</span><span class="foreground-15">(seed)                </span><span class="foreground-7">! deallocate space </span><span class="foreground-15">                  <span class="background-0"> 
</span></span><span class="foreground-8"> 23 </span><span class="foreground-15">      </span><span class="foreground-12">endif</span><span class="foreground-15">                                                                    <span class="background-0"> 
</span></span><span class="foreground-8"> 24 </span><span class="foreground-15">      </span><span class="foreground-11">call</span><span class="foreground-15"> </span><span class="foreground-11">random_number</span><span class="foreground-15">(r)                                                    <span class="background-0"> </span>               
</span><span class="foreground-8"> 25 </span><span class="foreground-15">      ran1</span><span class="foreground-14">=</span><span class="foreground-15">r                                                                   <span class="background-0"> 
</span></span><span class="foreground-8"> 26 </span><span class="foreground-15">  </span><span class="foreground-14">end function</span><span class="foreground-15"> ran1                                                            <span class="background-0"> 
</span></span><span class="foreground-8"> 27 </span><span class="foreground-14">end module</span><span class="foreground-15">                                                                     <span class="background-0"> </span>                    
</span><span class="foreground-8"> 28 </span><span class="foreground-15">                                                                               <span class="background-0"> </span>        
</span><span class="foreground-8"> 29 </span><span class="foreground-14">program</span><span class="foreground-15"> darwin                                                                 <span class="background-0"> </span>              
</span><span class="foreground-8"> 30 </span><span class="foreground-15">    </span><span class="foreground-14">use</span><span class="foreground-15"> numz                                                                   <span class="background-0"> </span>               
</span><span class="foreground-8">~                                                                                                       
~                                                                                                       
</span><span class="background-0"><span class="foreground-15">fortran.f90                                                                           1,1            All
</span></span><span class="foreground-15">:VimFilerExplorer
